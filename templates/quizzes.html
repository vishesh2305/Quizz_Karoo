<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Quizz-Karoo - All Quizzes</title>
    <link rel="stylesheet" href="/static/Educational_quiz_container/edu_quiz_style.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='Educational_quiz_container/edu_quiz_style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cabin:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <header id="header">
        <nav id="navbar">
            <div id="logo-container">
                <figure>
                    <img src="/static/logo.jpg" alt="Logo_img">
                </figure>
            </div>

            <div id="searchbar-container">
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="search-btn" type="submit">Search</button>
                </form>
            </div>

            <div id="buttons-container">
                <span id="profile-section">
                    <figure>
                        <img src="/static/logo.jpg" alt="image">
                    </figure>
                </span>
            </div>
        </nav>
    </header>

    <main id="main">
        <section id="sidebar-main">
            <div class="row">
                <div class="col-4 w-full" id="col-4">
                    <div id="list-example" class="list-group">
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Educational Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Food Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Political Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Geographical Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Current Affairs Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Historical Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Health Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Scientific Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">Household Item Quiz</a>
                        <a class="list-group-item list-group-item-action btns-sidebar-main" href="#">General Knowledge Quiz</a>
                    </div>
                </div>
            </div>
        </section>

        <section id="content-section-main">
            <h1>All Quizzes</h1>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            {% for quiz in quizzes %}
            <h2>{{ quiz.title }}</h2>
                <div class="survey-questions">
                    <p>{{ quiz.description }}</p>
                    <p>Created by User ID: {{ quiz.created_by }}</p>

                    <!-- Show result if this quiz was just submitted -->
                    {% if quiz_result_id == quiz.id %}
                        <p><strong>Your Score: {{ quiz_score }} / {{ quiz_total }}</strong></p>
                    {% endif %}

                    <form action="{{ url_for('auth.submit_quiz', quiz_id=quiz.id) }}" method="POST">
                        {% for question in quiz.questions %}
                            <div>
                                <p><strong>{{ question.text }}</strong></p>
                                <ul>
                                    {% for option in question.options %}
                                        <li>
                                            <input type="radio" name="question_{{ question.id }}" value="{{ option.id }}" required>
                                            <label>{{ option.text }}</label>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endfor %}
                        <button type="submit" class="button-39">Submit Quiz</button>
                    </form>

                    <!-- Admin Controls -->
                    {% if current_user.is_admin %}
                        <a href="{{ url_for('auth.edit_quiz', quiz_id=quiz.id) }}" class="button-39">Edit Quiz</a>
                        <form action="{{ url_for('auth.delete_quiz', quiz_id=quiz.id) }}" method="POST" style="display:inline;">
                            <button type="submit" onclick="return confirm('Are you sure you want to delete this quiz?')" class="button-39">Delete Quiz</button>
                        </form>
                    {% endif %}
                </div>
            {% endfor %}

            <a href="{{ url_for('auth.dashboard') }}" class="button-39">Back to Dashboard</a>
        </section>
    </main>
</body>

</html>
